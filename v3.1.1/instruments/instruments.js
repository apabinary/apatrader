define(["exports","jquery","jquery-ui","websockets/binary_websockets","navigation/menu","charts/chartWindow","jquery-growl","common/util"],function(a,b,c,d,e,f){"use strict";function g(a){return a&&a.__esModule?a:{"default":a}}function h(){k["default"].send({active_symbols:"brief"}).then(function(a){{var b=[];_(a.active_symbols).groupBy("market").map(function(a){var c=_.head(a),d={name:c.market,display_name:c.market_display_name};return d.submarkets=_(a).groupBy("submarket").map(function(a){var c=_.head(a),d={name:c.submarket,display_name:c.submarket_display_name};return d.instruments=_.map(a,function(a){return b.push(a.symbol),{symbol:a.symbol,display_name:a.display_name}}),d}).value(),d}).value()}n=o.map(function(a){return{display_name:a.display_name,name:a.name,submarkets:a.submarkets.map(function(a){return{display_name:a.display_name,instruments:a.instruments.filter(function(a){return-1!==b.indexOf(a.symbol)})}}).filter(function(a){return 0!==a.instruments.length})}}).filter(function(a){return 0!==a.submarkets.length}),n=l["default"].sortMenu(n);var c=j["default"]("#nav-menu").find(".instruments");c.find("> ul").remove();var d=j["default"]("<ul>").appendTo(c);l["default"].refreshMenu(d,n,i)})}function i(a){var b=a.data("delay_amount"),c=a.data("symbol"),d=a.data("display_name");m["default"].addNewWindow({instrumentCode:c,instrumentName:d,timePeriod:"1d",type:"candlestick",delayAmount:b})}Object.defineProperty(a,"__esModule",{value:!0}),a.getSpecificMarketData=a.isMarketDataPresent=a.getMarketData=a.init=void 0;var j=g(b),k=(g(c),g(d)),l=g(e),m=g(f),n=[],o=[],p=a.init=function(){return k["default"].cached.send({trading_times:(new Date).toISOString().slice(0,10)}).then(function(a){o=l["default"].extractChartableMarkets(a),h(),require(["websockets/binary_websockets"],function(a){a.events.on("login",h),a.events.on("logout",h)});j["default"]("#nav-menu").find(".instruments").on("mouseleave",h);return o})},q=a.getMarketData=function(){return n},r=a.isMarketDataPresent=function(a,b){var c=!1;b||(b=n);var d=this;return j["default"].each(b,function(b,e){return e.submarkets||e.instruments?c=d.isMarketDataPresent(a,e.submarkets||e.instruments):j["default"].trim(e.display_name)==j["default"].trim(a)&&(c=!0),!c}),c},s=a.getSpecificMarketData=function(a,b){var c={};b||(b=n);var d=this;return j["default"].each(b,function(b,e){return e.submarkets||e.instruments?c=d.getSpecificMarketData(a,e.submarkets||e.instruments):j["default"].trim(e.display_name)==j["default"].trim(a)&&(c=e),j["default"].isEmptyObject(c)}),c};a["default"]={init:p,getMarketData:q,isMarketDataPresent:r,getSpecificMarketData:s}});