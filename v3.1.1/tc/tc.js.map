{"version":3,"sources":["../../../../src/tc/tc.es6"],"names":["win","events","on","data","dialog","authorize","is_virtual","Promise","all","cached","send","landing_company_details","landing_company_name","website_status","get_settings","name","terms_conditions_version","client_tnc_status","div","i18n","find","html","click","createBlankWindow","title","width","minHeight","height","resizable","collapsable","minimizable","maximizable","closable","modal","closeOnEscape","ignoreTileAction","destroy","appendTo","append"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA,OAAIA,MAAM,IAAV;;AAEA,+BAAQC,MAAR,CAAeC,EAAf,CAAkB,OAAlB;AAAA,8DAA2B,iBAAOC,IAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACxB,yBAAIH,GAAJ,EAAS;AACNA,4BAAII,MAAJ,CAAW,SAAX;AACAJ,8BAAM,IAAN;AACF;;AAJuB,0BAKpBG,KAAKE,SAAL,CAAeC,UALK;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,4BASgDC,QAAQC,GAAR,CAAY,CAC9E,4BAAQC,MAAR,CAAeC,IAAf,CAAoB,EAACC,yBAAyBR,KAAKE,SAAL,CAAeO,oBAAzC,EAApB,CAD8E,EAE9E,4BAAQH,MAAR,CAAeC,IAAf,CAAoB,EAAC,kBAAkB,CAAnB,EAApB,CAF8E,EAG9E,4BAAQA,IAAR,CAAa,EAAC,gBAAgB,CAAjB,EAAb,CAH8E,CAAZ,CAThD;;AAAA;AAAA;AAAA;AASjBC,4CATiB;AASQE,mCATR;AASwBC,iCATxB;;AAcxB,yBAAIH,wBAAwBA,uBAAxB,IAAmDA,wBAAwBA,uBAAxB,CAAgDI,IAAnG,IACEF,eAAeA,cADjB,IACmCC,aAAaA,YADhD,IAEED,eAAeA,cAAf,CAA8BG,wBAA9B,KAA2DF,aAAaA,YAAb,CAA0BG,iBAF3F,EAE8G;AACrGC,2BADqG,GAC/F,oCAAQC,IAAR,EAD+F;;AAE3GD,4BAAIE,IAAJ,CAAS,uBAAT,EAAkCC,IAAlC,CAAuCV,wBAAwBA,uBAAxB,CAAgDI,IAAvF;AACAG,4BAAIE,IAAJ,CAAS,SAAT,EAAoBE,KAApB,CAA0B,YAAM;AAC7B,uDAAQZ,IAAR,CAAa,EAAC,gBAAgB,CAAjB,EAAb;AACAV,+BAAII,MAAJ,CAAW,SAAX;AACF,yBAHD;AAIAJ,8BAAM,kBAAQuB,iBAAR,CAA0B,sBAAE,QAAF,CAA1B,EAAuC;AAC1CC,kCAAO,uBAAuBL,IAAvB,EADmC;AAE1CM,kCAAO,GAFmC;AAG1CC,sCAAW,EAH+B;AAI1CC,mCAAQ,GAJkC;AAK1CC,sCAAW,KAL+B;AAM1CC,wCAAa,KAN6B;AAO1CC,wCAAa,KAP6B;AAQ1CC,wCAAa,KAR6B;AAS1CC,qCAAU,KATgC;AAU1CC,kCAAO,IAVmC;AAW1CC,0CAAe,KAX2B;AAY1CC,6CAAkB,IAZwB;AAa1C,8CAAmB,MAbuB;AAc1CC,oCAAS,mBAAM;AACZpC,oCAAM,IAAN;AACF;AAhByC,yBAAvC,CAAN;AAkBAkB,4BAAImB,QAAJ,CAAarC,GAAb;AACA;AACA,8CAAE,MAAF,EAAUsC,MAAV,CAAiBtC,IAAII,MAAJ,CAAW,QAAX,CAAjB;AACAJ,4BAAII,MAAJ,CAAW,MAAX;AACF;;AA7CuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA3B;;AAAA;AAAA;AAAA;AAAA;;qBAgDe,E","file":"tc.js","sourcesContent":["/**\r\n * Created by arnab on 5/2/16.\r\n */\r\nimport $ from \"jquery\";\r\nimport windows from \"../windows/windows\";\r\nimport liveapi from \"../websockets/binary_websockets\";\r\n\r\nimport html from 'text!./tc.html';\r\nimport 'css!./tc.css';\r\n\r\nlet win = null;\r\n\r\nliveapi.events.on(\"login\", async (data) => {\r\n   if (win) {\r\n      win.dialog('destroy');\r\n      win = null;\r\n   }\r\n   if (data.authorize.is_virtual) {\r\n      return;\r\n   }\r\n\r\n   const [landing_company_details, website_status, get_settings  ] = await Promise.all([\r\n         liveapi.cached.send({landing_company_details: data.authorize.landing_company_name}),\r\n         liveapi.cached.send({\"website_status\": 1}),\r\n         liveapi.send({\"get_settings\": 1})\r\n      ]);\r\n   if (landing_company_details.landing_company_details && landing_company_details.landing_company_details.name\r\n      && website_status.website_status && get_settings.get_settings\r\n      && website_status.website_status.terms_conditions_version !== get_settings.get_settings.client_tnc_status) {\r\n      const div = $(html).i18n();\r\n      div.find('.tc_landing_comp_name').html(landing_company_details.landing_company_details.name);\r\n      div.find('.button').click(() => {\r\n         liveapi.send({\"tnc_approval\": 1});\r\n         win.dialog('destroy');\r\n      });\r\n      win = windows.createBlankWindow($('<div/>'), {\r\n         title: 'Terms and Conditions'.i18n(),\r\n         width: 580,\r\n         minHeight: 90,\r\n         height: 220,\r\n         resizable: false,\r\n         collapsable: false,\r\n         minimizable: false,\r\n         maximizable: false,\r\n         closable: false,\r\n         modal: true,\r\n         closeOnEscape: false,\r\n         ignoreTileAction: true,\r\n         'data-authorized': 'true',\r\n         destroy: () => {\r\n            win = null;\r\n         }\r\n      });\r\n      div.appendTo(win);\r\n      //This helps in showing multiple dialog windows in modal form\r\n      $('body').append(win.dialog('widget'));\r\n      win.dialog('open');\r\n   }\r\n});\r\n\r\nexport default {};\r\n\r\n"]}